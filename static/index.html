<!DOCTYPE html>
<html>
<head>
    <title>Open Clipboard</title>
    <style>
        body { font-family: sans-serif; margin: 20px; background: #f4f4f4; }
        textarea { width: 100%; height: 80vh; padding: 10px; border-radius: 8px; border: 1px solid #ccc; font-size: 1.1rem; }
        #status { font-size: 0.8rem; color: #666; }
    </style>
</head>
<body>
    <h2>Room: <span id="room-name"></span></h2>
    <p id="status">Syncing...</p>
    <textarea id="editor" placeholder="Start typing..."></textarea>

    <div class="toolbar">
        <button id="saveBtn">Save</button>
        <button id="clearBtn">Clear</button>
        <div class="status-container">
            <span id="statusDot" class="dot online"></span>
            <span id="statusText">Connected</span>
        </div>
    </div>
    <script>
        const roomID = window.location.pathname.substring(1) || 'global';
        document.getElementById('room-name').innerText = roomID;
        
        const socket = new WebSocket(`ws://${window.location.host}/ws/${roomID}`);
        const editor = document.getElementById('editor');

        socket.onmessage = (event) => {
            // Update text only if we aren't the ones typing
            if (document.activeElement !== editor) {
                editor.value = event.data;
            }
        };

        editor.addEventListener('input', () => {
            socket.send(editor.value);
        });
    </script>
</body>
</html>
